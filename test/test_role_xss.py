import pytest
from cloudbluepentest.module.base import *
from cloudbluepentest.module.roles import *
from cloudbluepentest.resources.role_XSS_inject_data import data as role_XSS_inject_data
from cloudbluepentest.utils.logger import TestLogger


@pytest.mark.parametrize("payload", [payload for payload in role_XSS_inject_data['payloads']])
def test_role_XSS_inject(payload):
    cb = newSession()
    login(cb, role_XSS_inject_data['username'],
          role_XSS_inject_data['password'])
    roleEdit(cb, payload, role_XSS_inject_data['role_form_data'])
    closeSession(cb)

